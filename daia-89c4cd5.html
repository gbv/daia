<!DOCTYPE html>
<html lang="de_DE">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Jakob Voß" />
  <meta name="date" content="2015-05-18" />
  <title>Document Availability Information API (DAIA)</title>
   <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <style type="text/css">
/*<![CDATA[*/
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
/*]]>*/
  </style>
  <style type="text/css">
  body { font-family: sans-serif; }
  a { text-decoration: none }
  a:hover { text-decoration: underline }
  h1 { font: 170% sans-serif }
  h1.title { font-size: 200%; font-weight: bold; }
  h2 { font: 140% sans-serif }
  h3 { font: 120% sans-serif }
  dt { font-weight: bold; }
  h1, h2, h3, h1 a, h2 a, h3 a { color: #005A9C; }
  table { border-collapse: collapse; }
  td { border: 1px solid #999; padding: 3px }
  dl p { margin-top: 0; }
  dt { margin-top: 0.8em; }
  dd { margin-left: 1.5em; }
  ol { margin-bottom: 1em; }
  table + p { margin-top: 1em; }
  </style>
</head>
<body>
<a href="http://github.com/gbv/daia/"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" alt="Fork me on GitHub"></a>
<header>
<h1 class="title">Document Availability Information API (DAIA)</h1>
<h3 class="author">Jakob Voß</h3>
<h4 class="date">2015-05-18 (version 0.9.1)</h4>
</header>

<h1>Table of Contents</h1>
<nav id="TOC">
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a><ul>
<li><a href="#status-of-this-document"><span class="toc-section-number">1.1</span> Status of this document</a></li>
<li><a href="#conformance-requirements"><span class="toc-section-number">1.2</span> Conformance requirements</a></li>
</ul></li>
<li><a href="#data-format"><span class="toc-section-number">2</span> Data format</a><ul>
<li><a href="#simple-data-types"><span class="toc-section-number">2.1</span> Simple data types</a></li>
<li><a href="#daia-response"><span class="toc-section-number">2.2</span> DAIA response</a></li>
<li><a href="#documents"><span class="toc-section-number">2.3</span> Documents</a></li>
<li><a href="#items"><span class="toc-section-number">2.4</span> Items</a></li>
<li><a href="#services"><span class="toc-section-number">2.5</span> Services</a></li>
<li><a href="#daia-simple"><span class="toc-section-number">2.6</span> DAIA Simple</a></li>
</ul></li>
<li><a href="#request-and-response"><span class="toc-section-number">3</span> Request and response</a><ul>
<li><a href="#query-parameters"><span class="toc-section-number">3.1</span> Query parameters</a></li>
<li><a href="#request-headers"><span class="toc-section-number">3.2</span> Request headers</a></li>
<li><a href="#response-headers"><span class="toc-section-number">3.3</span> Response headers</a></li>
<li><a href="#error-responses"><span class="toc-section-number">3.4</span> Error responses</a></li>
<li><a href="#authentification"><span class="toc-section-number">3.5</span> Authentification</a></li>
<li><a href="#patron-specific-availability"><span class="toc-section-number">3.6</span> Patron-specific availability</a></li>
</ul></li>
<li><a href="#references"><span class="toc-section-number">4</span> References</a><ul>
<li><a href="#normative-references"><span class="toc-section-number">4.1</span> Normative References</a></li>
<li><a href="#informal-references"><span class="toc-section-number">4.2</span> Informal References</a></li>
<li><a href="#revision-history"><span class="toc-section-number">4.3</span> Revision history</a></li>
<li><a href="#acknowledgements"><span class="toc-section-number">4.4</span> Acknowledgements</a></li>
</ul></li>
</ul>
</nav>
<section id="introduction" class="level1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>The <strong>Document Availability Information API (DAIA)</strong> defines a data model of document availability encoded in JSON, and a HTTP based interface to query document availability information.</p>
<section id="status-of-this-document" class="level2">
<h2><span class="header-section-number">1.1</span> Status of this document</h2>
<p>All sources and updates can be found in a public git repository at <a href="http://github.com/gbv/daia">http://github.com/gbv/daia</a>. See the <a href="#releases">list of releases</a> at <a href="https://github.com/gbv/daia/releases">https://github.com/gbv/daia/releases</a> for functional changes.</p>
<p>The master file <a href="https://github.com/gbv/daia/blob/master/daia.md">daia.md</a> is written in <a href="http://johnmacfarlane.net/pandoc/demo/example9/pandocs-markdown.html">Pandoc’s Markdown</a>. HTML version of the specification is generated from the master file with <a href="https://github.com/jakobib/makespec">makespec</a>. The specification can be distributed freely under the terms of <a href="http://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>.</p>
</section>
<section id="conformance-requirements" class="level2">
<h2><span class="header-section-number">1.2</span> Conformance requirements</h2>
<p>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL” in this document are to be interpreted as described in RFC 2119.</p>
</section>
</section>
<section id="data-format" class="level1">
<h1><span class="header-section-number">2</span> Data format</h1>
<p>The DAIA data model basically consists of abstract <a href="#documents">documents</a>, concrete holdings of documents (<a href="#items">items</a>), and document <a href="#services">services</a>, with an availability status. The data model is encoded in JSON as <a href="#daia-response">DAIA response</a>.</p>
<section id="simple-data-types" class="level2">
<h2><span class="header-section-number">2.1</span> Simple data types</h2>
<p>The following data types are used to defined <a href="#daia-response">DAIA response</a> format and <a href="#daia-simple">DAIA Simple</a> format.</p>
<dl>
<dt>string</dt>
<dd>A Unicode string. A DAIA client MUST treat fields with empty string value equal to non-existing fields.
</dd>
<dt>URI</dt>
<dd>A syntactically correct URI.
</dd>
<dt>URL</dt>
<dd>A syntactically correct HTTP or HTTPS URL.
</dd>
<dt>count</dt>
<dd>A non-negative integer.
</dd>
<dt>boolean</dt>
<dd>A Boolean value (<code>true</code> or <code>false</code>).
</dd>
<dt>datetime</dt>
<dd>An instant of time specified in the form <code>YYYY-MM-DDThh:mm:ss(.ss)?(Z|[+-]hh:mm)?</code> as defined with <a href="http://www.w3.org/TR/xmlschema-2/#dateTime">XML Schema datatype xsd:dateTime</a>. A timezone indicator SHOULD be included.
</dd>
<dt>anydate</dt>
<dd>A date as defined with <a href="http://www.w3.org/TR/xmlschema-2/#date">XML Schema datatype xsd:date</a> (<code>YYYY-MM-DD(Z|[+-]hh:mm)?</code>), a datetime as defined above, or the string <code>unknown</code>. A timezone indicator SHOULD be included.
</dd>
<dt>duration</dt>
<dd>A duration as defined with <a href="http://www.w3.org/TR/xmlschema-2/#duration">XML Schema datatype xsd:duration</a> or the string <code>unknown</code>.
</dd>
<dt>service</dt>
<dd>An URI or string with one of values <code>presentation</code>, <code>loan</code>, <code>interloan</code>, and <code>openaccess</code>. DAIA clients SHOULD ignore other string values.
</dd>
<dt>entity</dt>
<dd><p>A JSON object with the following optional fields:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">id</td>
<td style="text-align: left;">URI</td>
<td style="text-align: left;">globally unique identifier of the entity</td>
</tr>
<tr class="even">
<td style="text-align: left;">href</td>
<td style="text-align: left;">URL</td>
<td style="text-align: left;">human-readable web page about the entity</td>
</tr>
<tr class="odd">
<td style="text-align: left;">content</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">human-readable label, title or description of the entity</td>
</tr>
</tbody>
</table>
<p>The language of field <code>content</code> SHOULD be given with HTTP <a href="#response-headers">response header</a> <code>Content-Language</code>. A DAIA client MAY use the <code>id</code> to retrieve additional information about the entity and it MAY override fields <code>href</code> and/or <code>content</code> with this information.</p>
</dd>
</dl>
</section>
<section id="daia-response" class="level2">
<h2><span class="header-section-number">2.2</span> DAIA response</h2>
<p>A DAIA response is a JSON object with three optional fields:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">institution</td>
<td style="text-align: left;">entity</td>
<td style="text-align: left;">institution that grants or knows about services and their availability</td>
</tr>
<tr class="even">
<td style="text-align: left;">document</td>
<td style="text-align: left;">array of <a href="#documents">documents</a></td>
<td style="text-align: left;">documents matching the processed request identifiers</td>
</tr>
<tr class="odd">
<td style="text-align: left;">timestamp</td>
<td style="text-align: left;">datetime</td>
<td style="text-align: left;">time the DAIA response was generated</td>
</tr>
</tbody>
</table>
<p>A DAIA response sent by a DAIA server in response to a request MUST only contain <a href="#documents">documents</a> matching queried <a href="#query-parameters">request identifiers</a>. A document matches a given request identifier if the request identifier is repeated in document field <code>id</code>, <code>requested</code>, or both. A DAIA response MAY contain multiple documents that match the esame request identifier.</p>
<p>DAIA clients MUST treat fields with empty JSON arrays (possible fields <code>document</code>, <code>item</code>, <code>available</code>, <code>unavailable</code>, and <code>limitation</code>) equal to non-existing fields. A DAIA server MAY include additional fields not included in this specification. Additional fields SHOULD be ignored by DAIA clients.</p>
</section>
<section id="documents" class="level2">
<h2><span class="header-section-number">2.3</span> Documents</h2>
<p>A <strong>document</strong> is a JSON object with one mandatory and four optional fields:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;"></th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">id</td>
<td style="text-align: left;">URI</td>
<td style="text-align: left;">mandatory</td>
<td style="text-align: left;">globally unique identifier of the document</td>
</tr>
<tr class="even">
<td style="text-align: left;">requested</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">optional</td>
<td style="text-align: left;">request identifier matching this document</td>
</tr>
<tr class="odd">
<td style="text-align: left;">href</td>
<td style="text-align: left;">URL</td>
<td style="text-align: left;">optional</td>
<td style="text-align: left;">human-readable web page about the document</td>
</tr>
<tr class="even">
<td style="text-align: left;">about</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">optional</td>
<td style="text-align: left;">textual description of the document</td>
</tr>
<tr class="odd">
<td style="text-align: left;">item</td>
<td style="text-align: left;">array of item</td>
<td style="text-align: left;">optional</td>
<td style="text-align: left;">set of instances or copies of the document</td>
</tr>
</tbody>
</table>
<p>Documents typically refer to works or editions of publications.</p>
<section id="example" class="level3 unnumbered">
<h3>Example</h3>
<p>A DAIA server at <code>http://example.org/</code> is queried with <a href="#query-parameters">request identifier</a> <code>PPN 62486362X</code>. The DAIA server returns an institution and a document. The request identifier is mapped to the document URI <code>http://d-nb.info/1001703464</code>:</p>
<pre><code>GET /?format=json&amp;id=PPN%2062486362X HTTP/1.1
Host: example.org
User-Agent: MyDAIAClient/1.0
Accept: application/json

HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8
Content-Language: en
X-DAIA-Version: 1.0.0</code></pre>
<pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;institution&quot;</span><span class="fu">:</span> <span class="fu">{</span>
    <span class="dt">&quot;content&quot;</span><span class="fu">:</span> <span class="st">&quot;Staats- und Universitätsbibliothek Hamburg&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;href&quot;</span><span class="fu">:</span> <span class="st">&quot;http://www.sub.uni-hamburg.de/&quot;</span>
  <span class="fu">},</span>
  <span class="dt">&quot;document&quot;</span><span class="fu">:</span> <span class="ot">[</span>
    <span class="fu">{</span>
      <span class="dt">&quot;href&quot;</span><span class="fu">:</span> <span class="st">&quot;https://kataloge.uni-hamburg.de/DB=1/PPNSET?PPN=62486362X&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;http://d-nb.info/1001703464&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;requested&quot;</span><span class="fu">:</span> <span class="st">&quot;PPN 62486362X&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;about&quot;</span><span class="fu">:</span> <span class="st">&quot;Emma Goldman: Gelebtes Leben. Ed. Nautilus, 2010&quot;</span>
    <span class="fu">}</span>
  <span class="ot">]</span>
<span class="fu">}</span></code></pre>
</section>
</section>
<section id="items" class="level2">
<h2><span class="header-section-number">2.4</span> Items</h2>
<p>An <strong>item</strong> is a JSON object with the following optional fields:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">id</td>
<td style="text-align: left;">URI</td>
<td style="text-align: left;">globally unique identifier of the item</td>
</tr>
<tr class="even">
<td style="text-align: left;">href</td>
<td style="text-align: left;">URL</td>
<td style="text-align: left;">human-readable web page about the item</td>
</tr>
<tr class="odd">
<td style="text-align: left;">part</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">whether and how the item is partial</td>
</tr>
<tr class="even">
<td style="text-align: left;">label</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">call number or similar item label for finding or identification</td>
</tr>
<tr class="odd">
<td style="text-align: left;">about</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">textual description of the item</td>
</tr>
<tr class="even">
<td style="text-align: left;">department</td>
<td style="text-align: left;">entity</td>
<td style="text-align: left;">an administrative sub-entitity of the institution</td>
</tr>
<tr class="odd">
<td style="text-align: left;">storage</td>
<td style="text-align: left;">entity</td>
<td style="text-align: left;">a physical location of the item (stacks, floor etc.)</td>
</tr>
<tr class="even">
<td style="text-align: left;">available</td>
<td style="text-align: left;">array of available</td>
<td style="text-align: left;">set of available <a href="#services">services</a></td>
</tr>
<tr class="odd">
<td style="text-align: left;">unavailable</td>
<td style="text-align: left;">array of unavailable</td>
<td style="text-align: left;">set of unavailable <a href="#services">services</a></td>
</tr>
</tbody>
</table>
<p>Items refer to particular copies or holdings of documents. The value of field <code>part</code> must be one of <code>narrower</code> and <code>broader</code>, if given. Partial items refer to items which contain less (<code>narrower</code>) or more (<code>broader</code>) than the whole document. Some items MAY be identical with their document, for instance indistinguishable digital copies of a digital document. The field <code>part</code> MUST NOT be set in this case.</p>
<p>The <code>department</code> refers to a department of an institution that is resposible for or knows about availability of the item. DAIA clients SHOULD assume a general hierarchy between <code>institution</code>, <code>department</code>, and <code>storage</code>.</p>
<section id="example-1" class="level3 unnumbered">
<h3>Example</h3>
<p>The following DAIA response contains two documents in response to the request identifier <code>10.1007/978-3-531-19144-7_13</code>. The first document is a printed collection that contains the requested article as one part (<code>part</code> is <code>broader</code>). A copy of the collection is available for loan. The second document is a digital edition of the article. A copy of this article can be used within the the institution and for loan under special conditions but it is not available as Open Access.</p>
<pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;document&quot;</span><span class="fu">:</span> <span class="ot">[</span>
    <span class="fu">{</span>
      <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;urn:isbn:978-3-531-18621-4&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;requested&quot;</span><span class="fu">:</span> <span class="st">&quot;10.1007/978-3-531-19144-7_13&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;item&quot;</span><span class="fu">:</span> <span class="ot">[</span>
        <span class="fu">{</span>
          <span class="dt">&quot;part&quot;</span><span class="fu">:</span> <span class="st">&quot;broader&quot;</span><span class="fu">,</span>
          <span class="dt">&quot;available&quot;</span><span class="fu">:</span> <span class="ot">[</span> <span class="fu">{</span> <span class="dt">&quot;service&quot;</span><span class="fu">:</span> <span class="st">&quot;loan&quot;</span> <span class="fu">}</span> <span class="ot">]</span>
        <span class="fu">}</span>
      <span class="ot">]</span>
    <span class="fu">}</span><span class="ot">,</span>
    <span class="fu">{</span>
      <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;http://dx.doi.org/10.1007/978-3-531-19144-7_13&quot;</span><span class="fu">,</span> 
      <span class="dt">&quot;requested&quot;</span><span class="fu">:</span> <span class="st">&quot;10.1007/978-3-531-19144-7_13&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;item&quot;</span><span class="fu">:</span> <span class="ot">[</span>
        <span class="fu">{</span>
          <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;http://dx.doi.org/10.1007/978-3-531-19144-7_13&quot;</span><span class="fu">,</span> 
          <span class="dt">&quot;available&quot;</span><span class="fu">:</span> <span class="ot">[</span> 
            <span class="fu">{</span> <span class="dt">&quot;service&quot;</span><span class="fu">:</span> <span class="st">&quot;presentation&quot;</span> <span class="fu">}</span><span class="ot">,</span>
            <span class="fu">{</span> <span class="dt">&quot;service&quot;</span><span class="fu">:</span> <span class="st">&quot;loan&quot;</span><span class="fu">,</span>
              <span class="dt">&quot;limitation&quot;</span><span class="fu">:</span> <span class="ot">[</span> <span class="fu">{</span> <span class="dt">&quot;content&quot;</span><span class="fu">:</span> <span class="st">&quot;via VPN&quot;</span> <span class="fu">}</span> <span class="ot">]</span> <span class="fu">}</span>
          <span class="ot">]</span><span class="fu">,</span>
          <span class="dt">&quot;unavailable&quot;</span><span class="fu">:</span> <span class="ot">[</span> <span class="fu">{</span> <span class="dt">&quot;service&quot;</span><span class="fu">:</span> <span class="st">&quot;openaccess&quot;</span> <span class="fu">}</span> <span class="ot">]</span>
        <span class="fu">}</span>
      <span class="ot">]</span>
    <span class="fu">}</span>
  <span class="ot">]</span>
<span class="fu">}</span></code></pre>
</section>
</section>
<section id="services" class="level2">
<h2><span class="header-section-number">2.5</span> Services</h2>
<p>A service is something that an item is currently accessible or unaccessible for (<a href="#items">item</a> fields <code>available</code> and <code>unavailable</code>). DAIA defines the following service types:</p>
<dl>
<dt>presentation</dt>
<dd>the item is accessible within the institution (in their rooms, in their intranet).
</dd>
<dt>loan</dt>
<dd>the item is accessible outside of the institution (by lending or online access) for a limited time.
</dd>
<dt>openaccess</dt>
<dd>the item is accessible freely without any restrictions by the institution (Open Access or free copies).
</dd>
<dt>interloan</dt>
<dd>the item is accessible mediated by another institution.
</dd>
</dl>
<p>An item can further be available for an unspecified service type and for additional service types identified by URIs. The following URIs can be used equivalent to DAIA services:</p>
<ul>
<li><a href="http://purl.org/ontology/dso#Presentation">http://purl.org/ontology/dso#Presentation</a> = presentation</li>
<li><a href="http://purl.org/ontology/dso#Loan">http://purl.org/ontology/dso#Loan</a> = loan</li>
<li><a href="http://purl.org/ontology/dso#Openaccess">http://purl.org/ontology/dso#Openaccess</a> = openaccess</li>
<li><a href="http://purl.org/ontology/dso#Interloan">http://purl.org/ontology/dso#Interloan</a> = interloan</li>
</ul>
<section id="available" class="level3 unnumbered">
<h3>available</h3>
<p>An <strong>available</strong> service is a JSON object with the following optional fields:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">service</td>
<td style="text-align: left;">service</td>
<td style="text-align: left;">the type of service being available</td>
</tr>
<tr class="even">
<td style="text-align: left;">href</td>
<td style="text-align: left;">URL</td>
<td style="text-align: left;">a link to perform, register or reserve the service</td>
</tr>
<tr class="odd">
<td style="text-align: left;">delay</td>
<td style="text-align: left;">duration</td>
<td style="text-align: left;">estimated delay (if given).</td>
</tr>
<tr class="even">
<td style="text-align: left;">limitation</td>
<td style="text-align: left;">array of entity</td>
<td style="text-align: left;">more specific limitations of the service</td>
</tr>
</tbody>
</table>
<p>If <code>delay</code> is missing, then there is probably no significant delay. If <code>delay</code> is <code>unknown</code>, then there is probably a delay but its duration is unknown.</p>
</section>
<section id="unavailable" class="level3 unnumbered">
<h3>unavailable</h3>
<p>An <strong>unavailable</strong> service is a JSON object with the following optional fields:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">service</td>
<td style="text-align: left;">service</td>
<td style="text-align: left;">the type of service being unavailable</td>
</tr>
<tr class="even">
<td style="text-align: left;">href</td>
<td style="text-align: left;">URL</td>
<td style="text-align: left;">a link to perform, register or reserve the service</td>
</tr>
<tr class="odd">
<td style="text-align: left;">expected</td>
<td style="text-align: left;">anydate</td>
<td style="text-align: left;">expected date when the service will be available again</td>
</tr>
<tr class="even">
<td style="text-align: left;">queue</td>
<td style="text-align: left;">count</td>
<td style="text-align: left;">number of waiting requests for this service</td>
</tr>
<tr class="odd">
<td style="text-align: left;">limitation</td>
<td style="text-align: left;">array of entity</td>
<td style="text-align: left;">more specific limitations of the service</td>
</tr>
</tbody>
</table>
<p>If <code>expected</code> is <code>unknown</code> then the service probably won’t be available in the future. If no <code>expected</code> value is given, it is not known when or whether the service will be available again.</p>
</section>
<section id="example-2" class="level3 unnumbered">
<h3>Example</h3>
<p>The following <a href="#items">item</a> is available for service <code>presentation</code>with a delay of two hours, unavailable for service <code>loan</code>, and currently unavailable for an additional service identified by URI <code>http://example.org/scan-this-book</code>.</p>
<pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;available&quot;</span><span class="fu">:</span> <span class="ot">[</span>
    <span class="fu">{</span> 
      <span class="dt">&quot;service&quot;</span><span class="fu">:</span> <span class="st">&quot;presentation&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;delay&quot;</span><span class="fu">:</span> <span class="st">&quot;PT2H&quot;</span> 
    <span class="fu">}</span>
  <span class="ot">]</span><span class="fu">,</span>
  <span class="dt">&quot;unavailable&quot;</span><span class="fu">:</span> <span class="ot">[</span>
    <span class="fu">{</span> 
      <span class="dt">&quot;service&quot;</span><span class="fu">:</span> <span class="st">&quot;loan&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;expected&quot;</span><span class="fu">:</span> <span class="st">&quot;unknown&quot;</span> 
    <span class="fu">}</span><span class="ot">,</span>
    <span class="fu">{</span>
      <span class="dt">&quot;service&quot;</span><span class="fu">:</span> <span class="st">&quot;http://example.org/scan-this-book&quot;</span>
    <span class="fu">}</span>
  <span class="ot">]</span>
<span class="fu">}</span></code></pre>
</section>
</section>
<section id="daia-simple" class="level2">
<h2><span class="header-section-number">2.6</span> DAIA Simple</h2>
<p><strong>DAIA Simple</strong> is a simplified version of <a href="#daia-response">DAIA response</a> format for a particular document limited to a typical use case of availability information. A DAIA simple object is a plain JSON object with the following fields:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">service</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">most relevant service (one of <code>openaccess</code>, <code>loan</code>, <code>presentation</code>, <code>none</code>)</td>
</tr>
<tr class="even">
<td style="text-align: left;">available</td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">whether the service is available or not</td>
</tr>
<tr class="odd">
<td style="text-align: left;">delay</td>
<td style="text-align: left;">duration</td>
<td style="text-align: left;">expected delay (only relevant if <code>available</code> is <code>true</code>)</td>
</tr>
<tr class="even">
<td style="text-align: left;">expected</td>
<td style="text-align: left;">anydate</td>
<td style="text-align: left;">expected date of availability (only relevant if <code>available</code> is <code>false</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">queue</td>
<td style="text-align: left;">count</td>
<td style="text-align: left;">length of waiting queue (only relevant if <code>available</code> is <code>false</code>)</td>
</tr>
<tr class="even">
<td style="text-align: left;">href</td>
<td style="text-align: left;">URL</td>
<td style="text-align: left;">optional URL to perform or request the service</td>
</tr>
<tr class="odd">
<td style="text-align: left;">limitation</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">optional string describing an additional limitation</td>
</tr>
</tbody>
</table>
<section id="examples" class="level3 unnumbered">
<h3>Examples</h3>
<pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span> <span class="dt">&quot;service&quot;</span><span class="fu">:</span> <span class="st">&quot;loan&quot;</span><span class="fu">,</span> <span class="dt">&quot;available&quot;</span><span class="fu">:</span> <span class="kw">true</span> <span class="fu">}</span>
<span class="fu">{</span> <span class="dt">&quot;service&quot;</span><span class="fu">:</span> <span class="st">&quot;loan&quot;</span><span class="fu">,</span> <span class="dt">&quot;available&quot;</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span> <span class="dt">&quot;expected&quot;</span><span class="fu">:</span> <span class="st">&quot;2014-12-07&quot;</span> <span class="fu">}</span>
<span class="fu">{</span> <span class="dt">&quot;service&quot;</span><span class="fu">:</span> <span class="st">&quot;presentation&quot;</span><span class="fu">,</span> <span class="dt">&quot;available&quot;</span><span class="fu">:</span> <span class="kw">true</span> <span class="fu">}</span>
<span class="fu">{</span> <span class="dt">&quot;service&quot;</span><span class="fu">:</span> <span class="st">&quot;openaccess&quot;</span><span class="fu">,</span> <span class="dt">&quot;available&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span>
  <span class="dt">&quot;href&quot;</span><span class="fu">:</span> <span class="st">&quot;http://dx.doi.org/10.1901%2Fjaba.1974.7-497a&quot;</span> <span class="fu">}</span></code></pre>
</section>
</section>
</section>
<section id="request-and-response" class="level1">
<h1><span class="header-section-number">3</span> Request and response</h1>
<p>A DAIA server is queried via HTTP or HTTPS GET request. HTTP methods HEAD and OPTIONS SHOULD also be supported.</p>
<p>A DAIA server MUST always return a <a href="#daia-response">DAIA response</a> or an <a href="#error-responses">error response</a> for HTTP GET requests.</p>
<p>The URL to query a DAIA server stripped from all query parameters is called its <strong>base URL</strong>. It is RECOMMENDED to use a HTTPS base URL.</p>
<section id="query-parameters" class="level2">
<h2><span class="header-section-number">3.1</span> Query parameters</h2>
<p>A DAIA server MUST respect following query parameters:</p>
<dl>
<dt>id</dt>
<dd>query id with one or multiple <strong>request identifiers</strong> of documents or items.
</dd>
<dt>format</dt>
<dd>set to <code>json</code>. If this parameter is missing or not set to <code>json</code>, a DAIA server SHOULD sent an <a href="#error-responses">error response</a> with HTTP status code 422 (invalid request). For backwards compatibility with DAIA 0.5, a DAIA server MAY also response with HTTP status code 200 and with an arbitrary document. The document returned in this case MUST NOT be JSON. A DAIA client MAY translate the document to a valid <a href="#daia-response">DAIA response</a>, for instance from XML.
</dd>
<dt>callback</dt>
<dd>a JavaScript callback method name to return JSONP instead of JSON. The callback MUST only contain alphanumeric characters and underscores.
</dd>
<dt>patron</dt>
<dd>a patron identifier for <a href="#patron-specific-availability">patron-specific availability</a>.
</dd>
<dt>access_token</dt>
<dd>an <a href="#authentification">access token</a> for authentification. A DAIA client MUST use HTTPS when sending access tokens.
</dd>
<dt>suppress_response_codes</dt>
<dd>if this parameter is present, all responses MUST be returned with a 200 OK status code, even an <a href="#error-responses">error response</a>. Support of this parameter is OPTIONAL.
</dd>
</dl>
<p>If the query id does not includes a vertical bar (<code>|</code> or <code>%7F</code> with URL encoding), a DAIA server MUST use its value as request identifier. Otherwise a DAIA server MUST split the query id at vertical bars into multiple request identifiers. A DAIA server MAY sent an <a href="#error-responses">error response</a> with HTTP status code 422 if it cannot handle multiple request identifiers or if the query id is too long. A PAIA server MAY choose to only process a subset of multiple request identifiers: in this case the response MUST include a <code>Link</code> <a href="#response-headers">response header</a> with a new request URL that includes a querd id with all remaining request identifiers, joined with vertical bars.</p>
<section id="example-3" class="level3 unnumbered">
<h3>Example</h3>
<p>A DAIA server with base URL <code>https://example.org/</code> is queried with a query id that contains five request identifiers. The server only processes the first three request identifiers and finds a matching document for one of them. The remaining request identifiers are included in a new request URL:</p>
<pre><code>GET /?format=json&amp;id=x:a|x:b|x:c|x:d|x:e HTTP/1.1
Host: example.org
User-Agent: MyDAIAClient/1.0
Accept: application/json

HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8
Content-Language: en
X-DAIA-Version: 1.0.0
Link: &lt;https://example.org/?format=json&amp;id=x:d|x:e&gt;; rel=&quot;next&quot;</code></pre>
<pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span> <span class="dt">&quot;document&quot;</span><span class="fu">:</span> <span class="ot">[</span> <span class="fu">{</span> <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;x:b&quot;</span> <span class="fu">}</span> <span class="ot">]</span> <span class="fu">}</span></code></pre>
</section>
</section>
<section id="request-headers" class="level2">
<h2><span class="header-section-number">3.2</span> Request headers</h2>
<p>A DAIA client SHOULD sent the following HTTP request headers:</p>
<dl>
<dt>User-Agent</dt>
<dd>with an appropriate client name and version number.
</dd>
<dt>Accept</dt>
<dd>with the value <code>application/json</code>.
</dd>
</dl>
<p>A DAIA client MAY sent the following HTTP request headers:</p>
<dl>
<dt>Accept-Language</dt>
<dd>to indicate preferred languages of textual response fields (<code>content</code>).
</dd>
<dt>Authorization</dt>
<dd>to provide an OAuth 2 Bearer token for <a href="#authentification">authentification</a>.
</dd>
</dl>
<p>For OPTIONS preflight requests of Cross-Origin Resource Sharing (CORS) a DAIA client MUST include the following HTTP request headers:</p>
<dl>
<dt>Origin</dt>
<dd>where the cross-origin request originates from.
</dd>
<dt>Access-Control-Request-Method</dt>
<dd>the HTTP verb <code>GET</code>.
</dd>
<dt>Access-Control-Request-Headers</dt>
<dd>the value <code>Authorization</code> if access tokens are sent as HTTP headers.
</dd>
</dl>
<p>Note that DAIA clients are not required to respect CORS rules. CORS preflight requests in browsers can be avoided by omitting the request headers <code>Accept</code> and <code>Authorization</code>.</p>
</section>
<section id="response-headers" class="level2">
<h2><span class="header-section-number">3.3</span> Response headers</h2>
<p>A DAIA server SHOULD sent the following HTTP response headers with every <a href="#daia-response">DAIA response</a>:</p>
<dl>
<dt>Content-Language</dt>
<dd>to indicate the language of textual response fields (<code>content</code>).
</dd>
<dt>Content-Type</dt>
<dd>the value <code>application/json</code> or <code>application/json; charset=utf-8</code> for JSON response; the value <code>application/javascript</code> or <code>application/javascript; charset=utf-8</code> for JSONP response.
</dd>
<dt>X-DAIA-Version</dt>
<dd>the version of DAIA specification which the server was checked against.
</dd>
<dt>Link</dt>
<dd>to refer to another <a href="#request-and-response">request URL</a> with unprocessed request identifiers and RFC 5988 relation type <code>next</code>.
</dd>
</dl>
</section>
<section id="error-responses" class="level2">
<h2><span class="header-section-number">3.4</span> Error responses</h2>
<p>A DAIA server SHOULD use HTTP status codes to indicate server errors and client request errors. An error response SHOULD include a JSON object with the following fields:</p>
<dl>
<dt>error</dt>
<dd>alphanumeric error code.
</dd>
<dt>code</dt>
<dd>HTTP status code.
</dd>
<dt>error_description</dt>
<dd>human-readable error description (optional).
</dd>
<dt>error_uri</dt>
<dd>human-readable web page about the error (optional).
</dd>
</dl>
<p>The following error responses are expected:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">error</th>
<th style="text-align: left;">code</th>
<th style="text-align: center;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>invalid_request</td>
<td style="text-align: left;">400</td>
<td>Malformed request, for instance malformed HTTP request headers</td>
</tr>
<tr class="even">
<td>invalid_grant</td>
<td style="text-align: left;">401</td>
<td>The <a href="#authentification">access token</a> was missing, invalid, or expired</td>
</tr>
<tr class="odd">
<td>insufficient_scope</td>
<td style="text-align: left;">403</td>
<td>The access token was accepted but it lacks permission for the request</td>
</tr>
<tr class="even">
<td>invalid_request</td>
<td style="text-align: left;">405</td>
<td>Unexpected HTTP verb</td>
</tr>
<tr class="odd">
<td>invalid_request</td>
<td style="text-align: left;">422</td>
<td>Missing or invalid query parameters</td>
</tr>
<tr class="even">
<td>internal_error</td>
<td style="text-align: left;">500</td>
<td>An unexpected error occurred, such as a serious bug</td>
</tr>
<tr class="odd">
<td>not_implemented</td>
<td style="text-align: left;">501</td>
<td>Access token was sent but no support of <a href="#patron-specific-availability">patron-specific availability</a></td>
</tr>
<tr class="even">
<td>bad_gateway</td>
<td style="text-align: left;">502</td>
<td>The request couldn’t be serviced because of a backend failure</td>
</tr>
<tr class="odd">
<td>service_unavailable</td>
<td style="text-align: left;">503</td>
<td>The request couldn’t be serviced because of a temporary failure</td>
</tr>
<tr class="even">
<td>gateway_timeout</td>
<td style="text-align: left;">504</td>
<td>The request couldn’t be serviced because of a backend failure</td>
</tr>
</tbody>
</table>
<p>A DAIA server SHOULD never return a HTTP 404 error if queried at its <a href="#query-parameters">base URL</a>. In particular a DAIA server MUST NOT respond with a HTTP 404 status code for missing or unknown <a href="#query-parameters">request identifiers</a>.</p>
</section>
<section id="authentification" class="level2">
<h2><span class="header-section-number">3.5</span> Authentification</h2>
<p>A DAIA server MAY support authentfication via OAuth 2.0 bearer tokens (RFC 6750). Access tokens can be provided either as URL query parameter <code>access_token</code> or in the HTTP <a href="#request-headers">request header</a> <code>Authorization</code>. For instance the following requests are equivalent:</p>
<pre><code>curl -H &quot;Authorization: Bearer vF9dft4qmT&quot; https://example.org/?format=json
curl -H https://example.org/?access_token=vF9dft4qmT&amp;format=json</code></pre>
<p>A DAIA server that supports authentification, MUST also support HTTP OPTIONS requests for CORS.</p>
<p>DAIA server and client MUST use HTTPS when sending and receiving access tokens.</p>
<p>Distribution of access tokens is out of the scope of this specification.</p>
<p>When also using Patrons Account Information API (PAIA) it is RECOMMENDED to issue access tokens via PAIA auth and add a scope named <code>read_availability</code> for authentificated access to a DAIA server.</p>
</section>
<section id="patron-specific-availability" class="level2">
<h2><span class="header-section-number">3.6</span> Patron-specific availability</h2>
<p>A DAIA server MAY support patron-specific availability with the <a href="#query-parameters">query parameter</a> <code>patron</code>. A DAIA server that does not support patron-specific availability SHOULD respond with <a href="#error-responses">error response</a> status 501 (not supported) when it receives a request with query parameter <code>patron</code>.</p>
<p>A DAIA server with support of patron-specific availability can return different <a href="#daia-response">DAIA response</a> for different values of <code>patron</code>.</p>
<p>The interpretation of <code>patron</code> values is not defined by DAIA. When also using PAIA it is RECOMMENDED to use PAIA patron identifiers and/or patron types.</p>
<p>A DAIA server SHOULD reject unknown or invalid patron values with <a href="#error-responses">error response</a> and HTTP status code 422.</p>
<p>Patron-specific availability SHOULD be combined with <a href="#authentification">authentification</a>.</p>
</section>
</section>
<section id="references" class="level1">
<h1><span class="header-section-number">4</span> References</h1>
<section id="normative-references" class="level2">
<h2><span class="header-section-number">4.1</span> Normative References</h2>
<ul>
<li><p>Berners-Lee, T., Fielding R., Masinter L. 1998. “Uniform Resource Identifiers (URI): Generic Syntax”. <a href="http://tools.ietf.org/html/rfc2396">http://tools.ietf.org/html/rfc2396</a></p></li>
<li><p>Biron, P. V., Malhotra, A. 2004. “XML Schema Part 2: Datatypes Second Edition”. <a href="http://www.w3.org/TR/xmlschema-2/">http://www.w3.org/TR/xmlschema-2/</a></p></li>
<li><p>Bradner, S. 1997. “RFC 2119: Key words for use in RFCs to Indicate Requirement Levels”. <a href="http://tools.ietf.org/html/rfc2119">http://tools.ietf.org/html/rfc2119</a></p></li>
<li><p>Crockford, D. 2006. “RFC 6427: The application/json Media Type for JavaScript Object Notation (JSON)”. <a href="http://tools.ietf.org/html/rfc4627">http://tools.ietf.org/html/rfc4627</a></p></li>
<li><p>Fielding, R. 1999. “RFC 2616: Hypertext Transfer Protocol”. <a href="http://tools.ietf.org/html/rfc2616">http://tools.ietf.org/html/rfc2616</a></p></li>
<li><p>Jones, M. and Hardt, D. 2012. “RFC 6750: The OAuth 2.0 Authorization Framework: Bearer Token Usage”. <a href="http://tools.ietf.org/html/rfc6750">http://tools.ietf.org/html/rfc6750</a>.</p></li>
<li><p>Nottingham, M. 2010. “RFC 5988: Web Linking”. <a href="http://tools.ietf.org/html/rfc5988">http://tools.ietf.org/html/rfc5988</a>.</p></li>
<li><p>van Kesteren, A. 2014. “Cross-Origin Resource Sharing” <a href="http://www.w3.org/TR/cors/">http://www.w3.org/TR/cors/</a></p></li>
</ul>
</section>
<section id="informal-references" class="level2">
<h2><span class="header-section-number">4.2</span> Informal References</h2>
<ul>
<li>Voß, J. 2015. “Patrons Account Information API (PAIA)” <a href="http://gbv.github.io/paia/">http://gbv.github.io/paia/</a></li>
</ul>
</section>
<section id="revision-history" class="level2">
<h2><span class="header-section-number">4.3</span> Revision history</h2>
<p>This is version <strong>0.9.1</strong> of DAIA specification, last modified at 2015-05-18 with revision <a href="http://github.com/gbv/daia/commit/89c4cd5de370a27cd2c5fcb8e907f5df0ced4170">89c4cd5</a>.</p>
<p>Version numbers follow <a href="http://semver.org/">Semantic Versioning</a>: each number consists of three numbers, optionally followed by <code>+</code> and a suffix:</p>
<ul>
<li>The major version (first number) is increased if changes require a modification of DAIA clients</li>
<li>The minor version (second number) is increased if changes require a modification a DAIA servers</li>
<li>The patch version (third number) is increased for backwards compatible fixes or extensions, such as the introduction of new optional fields</li>
<li>The optional suffix indicates informal changes in documentation</li>
</ul>
<section id="releases" class="level3 unnumbered">
<h3>Releases</h3>
<p>Releases with functional changes are tagged with a version number and included at <a href="https://github.com/gbv/daia/releases">https://github.com/gbv/daia/releases</a> with release notes.</p>
<section id="section" class="level4 unnumbered">
<h4>0.9.? (2015-05-??)</h4>
<ul>
<li>Dropped fields <code>message</code>, <code>version</code>, <code>schema</code></li>
<li>Made <code>format</code> query parameter mandatory</li>
<li>Removed DAIA/XML and DAIA/RDF</li>
<li>Specified processing of multiple request identifiers</li>
<li>Added field requested to map request identifiers to documents</li>
<li>Added authentification</li>
<li>Added patron-specific availability</li>
<li>Added CORS and HTTP OPTIONS</li>
<li>Added field about to document and item</li>
</ul>
</section>
<section id="section-1" class="level4 unnumbered">
<h4>0.8 (2015)</h4>
<ul>
<li>Added DAIA Simple</li>
</ul>
</section>
<section id="section-2" class="level4 unnumbered">
<h4>0.5 (2009)</h4>
<ul>
<li>First specification</li>
</ul>
</section>
</section>
<section id="full-changelog" class="level3 unnumbered">
<h3>Full changelog</h3>
<ul>
<li><a href="daia-51da264.html"><code>2015-05-18 10:35:17 +0200</code></a>: <a href="http://github.com/gbv/daia/commit/51da26491b0218b24b54f4659488897d255d39ba">improved example, added field ‘about’</a></li>
<li><a href="daia-d04debd.html"><code>2015-05-13 14:46:36 +0200</code></a>: <a href="http://github.com/gbv/daia/commit/d04debd63b7ac7c61178b93e1e5e2d720919dd62">finished first draft</a></li>
<li><a href="daia-aeafbcd.html"><code>2015-05-12 15:17:53 +0200</code></a>: <a href="http://github.com/gbv/daia/commit/aeafbcda12c4d83d89c07983441392c4caaf7bc9">started rewrite from scratch</a></li>
</ul>
</section>
</section>
<section id="acknowledgements" class="level2">
<h2><span class="header-section-number">4.4</span> Acknowledgements</h2>
<p>Thanks for contributions to DAIA specification from Uwe Reh, David Maus, Oliver Goldschmidt, Jan Frederik Maas, Jürgen Hofmann, Anne Christensen, and André Lahmann among others.</p>
</section>
</section>
</body>
</html>
